function calculate() {
    const resultDiv = document.getElementById('results');
    let result = '';

    // Revenue Calculation
    const price = parseFloat(document.getElementById('price').value) || 0;
    const sales = parseFloat(document.getElementById('sales').value) || 0;
    const totalRevenue = calculateAnnual('sales', 'salesFrequency') * price;

    // COGS Calculation
    const cogsMaterialsValue = parseFloat(document.getElementById('cogsMaterials').value) || 0;
    const cogsLaborValue = parseFloat(document.getElementById('cogsLabor').value) || 0;
    const cogsOverheadValue = parseFloat(document.getElementById('cogsOverhead').value) || 0;
    const cogsShippingValue = parseFloat(document.getElementById('cogsShipping').value) || 0;
    const totalCOGS = (cogsMaterialsValue + cogsLaborValue + cogsOverheadValue + cogsShippingValue) * sales;

    // Total Operational Costs
    const totalOperationalCosts = calculateAnnual('rent', 'rentFrequency') +
        calculateAnnual('utilities', 'utilitiesFrequency') +
        calculateAnnual('salaries', 'salariesFrequency') +
        calculateAnnual('marketing', 'marketingFrequency') +
        calculateAnnual('insurance', 'insuranceFrequency');

    // Total Building Costs
    const totalBuildingCosts = calculateAnnual('buildingRent', 'buildingRentFrequency') +
        calculateAnnual('buildingMaintenance', 'buildingMaintenanceFrequency') +
        calculateAnnual('buildingUtilities', 'buildingUtilitiesFrequency');

    // Total Vehicle Costs
    const totalVehicleCosts = calculateAnnual('vehicleGas', 'vehicleGasFrequency') +
        calculateAnnual('vehicleMaintenance', 'vehicleMaintenanceFrequency') +
        calculateAnnual('vehicleInsurance', 'vehicleInsuranceFrequency');

    // Sum up all costs
    const totalCosts = totalCOGS + totalOperationalCosts + totalBuildingCosts + totalVehicleCosts;

    // Calculate Net Income
    const netIncome = totalRevenue - totalCosts;

    // Convert results based on selected frequency
    const selectedValue = parseFloat(document.getElementById('resultChange').value);
    const totalOperationalCostsDivided = totalOperationalCosts / selectedValue;
    const totalBuildingCostsDivided = totalBuildingCosts / selectedValue;
    const totalVehicleCostsDivided = totalVehicleCosts / selectedValue;
    const netIncomeDivided = netIncome / selectedValue;

    // Display results
    result += `<h3>Total Revenue: ${totalRevenue.toFixed(2)}</h3>`;
    result += `<h3>Total COGS: ${totalCOGS.toFixed(2)}</h3>`;
    result += `<h3>Operational Costs Total: ${totalOperationalCostsDivided.toFixed(2)}</h3>`;
    result += `<h3>Building Costs Total: ${totalBuildingCostsDivided.toFixed(2)}</h3>`;
    result += `<h3>Vehicle Costs Total: ${totalVehicleCostsDivided.toFixed(2)}</h3>`;
    result += `<h3>Total Expenses: ${totalCosts.toFixed(2)}</h3>`;
    result += `<h3>Net Income: ${netIncomeDivided.toFixed(2)}</h3>`;

    resultDiv.innerHTML = result;
}
